---
import Container from "../components/Container.astro";
import Layout from "../layouts/Layout.astro";

const email = "contact@crablabs.io";
const emailHref = "mailto:contact@crablabs.io";
const phone = "(424) 271-5569";
const phoneHref = "tel:+14242715569";
---

<main id="content">
  <!-- Page Layout -->
  <Layout title="Get Project Quote | PCB Design & Embedded Systems | Fixed Price $2.5k+ | Crab Labs">
    <Container>
      <div class="max-w-6xl px-4 pt-16 pb-12 mx-auto">

        <!-- Header Section -->
        <div class="text-center mb-12">
          <h1 class="text-5xl font-bold text-slate-800 dark:text-slate-100 mb-6">Request Quote</h1>
          <p class="text-xl text-slate-600 dark:text-slate-300 max-w-3xl mx-auto leading-relaxed">
            Get an instant estimate with our smart calculator, then submit your detailed requirements for a formal quote.
          </p>
        </div>

        <!-- Calculator Section -->
        <div class="bg-gradient-to-br from-orange-50 to-orange-100 dark:from-slate-800 dark:to-slate-700 rounded-2xl p-8 mb-12 border-2 border-orange-200 dark:border-slate-600">
          <h2 class="text-2xl font-bold text-slate-800 dark:text-slate-100 mb-6 text-center">
            Smart Project Calculator
          </h2>

          <!-- Project Type Selection -->
          <div class="mb-8">
            <h3 class="text-lg font-bold text-slate-800 dark:text-slate-100 mb-4">Project Type</h3>
            <div class="grid md:grid-cols-3 gap-4">
              <label class="cursor-pointer">
                <input type="radio" name="calc-project-type" value="consulting" class="calc-project-type sr-only"
                       data-base-hours="15" data-description="Design review and analysis">
                <div class="p-4 border-2 border-slate-200 dark:border-slate-600 rounded-lg hover:border-orange-500 transition-colors calc-option-card bg-white dark:bg-slate-900">
                  <h4 class="font-bold text-slate-900 dark:text-white mb-2">Design Review & Consulting</h4>
                  <p class="text-sm text-slate-600 dark:text-slate-400 mb-2">Troubleshooting, design analysis, expert consultation</p>
                  <div class="text-sm text-orange-600 font-semibold">15-50 hours typical</div>
                </div>
              </label>

              <label class="cursor-pointer">
                <input type="radio" name="calc-project-type" value="development" class="calc-project-type sr-only"
                       data-base-hours="200" data-description="Complete product development">
                <div class="p-4 border-2 border-slate-200 dark:border-slate-600 rounded-lg hover:border-orange-500 transition-colors calc-option-card bg-white dark:bg-slate-900">
                  <h4 class="font-bold text-slate-900 dark:text-white mb-2">Product Development</h4>
                  <p class="text-sm text-slate-600 dark:text-slate-400 mb-2">Complete PCB design and firmware development</p>
                  <div class="text-sm text-orange-600 font-semibold">200-500 hours typical</div>
                </div>
              </label>

              <label class="cursor-pointer">
                <input type="radio" name="calc-project-type" value="testing" class="calc-project-type sr-only"
                       data-base-hours="40" data-description="Testing and documentation">
                <div class="p-4 border-2 border-slate-200 dark:border-slate-600 rounded-lg hover:border-orange-500 transition-colors calc-option-card bg-white dark:bg-slate-900">
                  <h4 class="font-bold text-slate-900 dark:text-white mb-2">Testing & Documentation</h4>
                  <p class="text-sm text-slate-600 dark:text-slate-400 mb-2">Compliance testing, validation, documentation</p>
                  <div class="text-sm text-orange-600 font-semibold">40-120 hours typical</div>
                </div>
              </label>
            </div>
          </div>

          <!-- Project Details -->
          <div id="calc-details" style="display: none;">
            <div class="grid md:grid-cols-2 gap-8">

              <!-- Left Column -->
              <div>
                <h3 class="text-lg font-bold text-slate-800 dark:text-slate-100 mb-4">Project Scope</h3>

                <!-- Complexity -->
                <div class="mb-6">
                  <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-3">Complexity Level</label>
                  <div class="space-y-2">
                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="complexity" value="simple" class="mr-3" data-multiplier="0.7">
                      <div class="flex-1">
                        <span class="font-medium text-slate-900 dark:text-white">Simple</span>
                        <span class="text-sm text-slate-600 dark:text-slate-400 block">Basic I/O, single MCU, minimal processing</span>
                      </div>
                    </label>
                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="complexity" value="moderate" class="mr-3" data-multiplier="1.0">
                      <div class="flex-1">
                        <span class="font-medium text-slate-900 dark:text-white">Moderate</span>
                        <span class="text-sm text-slate-600 dark:text-slate-400 block">Multiple sensors, communication protocols</span>
                      </div>
                    </label>
                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="complexity" value="complex" class="mr-3" data-multiplier="1.5">
                      <div class="flex-1">
                        <span class="font-medium text-slate-900 dark:text-white">Complex</span>
                        <span class="text-sm text-slate-600 dark:text-slate-400 block">High-speed signals, advanced processing, multiple protocols</span>
                      </div>
                    </label>
                  </div>
                </div>

                <!-- PCB Layers -->
                <div class="mb-6">
                  <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-3">PCB Layers</label>
                  <select name="pcb-layers" class="w-full p-3 border-2 border-slate-200 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-white">
                    <option value="2" data-hours="0">2 Layer (+0 hrs)</option>
                    <option value="4" data-hours="15">4 Layer (+15 hrs)</option>
                    <option value="6" data-hours="25">6 Layer (+25 hrs)</option>
                    <option value="8" data-hours="40">8+ Layer (+40 hrs)</option>
                  </select>
                </div>

                <!-- Component Count -->
                <div class="mb-6">
                  <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-3">Approximate Component Count</label>
                  <select name="component-count" class="w-full p-3 border-2 border-slate-200 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-white">
                    <option value="50" data-hours="0">Under 50 components (+0 hrs)</option>
                    <option value="100" data-hours="20">50-100 components (+20 hrs)</option>
                    <option value="200" data-hours="40">100-200 components (+40 hrs)</option>
                    <option value="300" data-hours="70">200+ components (+70 hrs)</option>
                  </select>
                </div>
              </div>

              <!-- Right Column -->
              <div>
                <h3 class="text-lg font-bold text-slate-800 dark:text-slate-100 mb-4">Additional Features</h3>

                <div class="space-y-3">
                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="features" value="wireless" class="mr-3" data-hours="25">
                    <span class="text-slate-700 dark:text-slate-300">Wireless Connectivity (BLE/WiFi/Cellular) <span class="text-orange-600">+25 hrs</span></span>
                  </label>

                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="features" value="battery" class="mr-3" data-hours="15">
                    <span class="text-slate-700 dark:text-slate-300">Battery Optimization <span class="text-orange-600">+15 hrs</span></span>
                  </label>

                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="features" value="display" class="mr-3" data-hours="20">
                    <span class="text-slate-700 dark:text-slate-300">Display/UI Implementation <span class="text-orange-600">+20 hrs</span></span>
                  </label>

                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="features" value="motor-control" class="mr-3" data-hours="35">
                    <span class="text-slate-700 dark:text-slate-300">Motor Control/Drive Circuits <span class="text-orange-600">+35 hrs</span></span>
                  </label>

                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="features" value="analog-frontend" class="mr-3" data-hours="30">
                    <span class="text-slate-700 dark:text-slate-300">Precision Analog Frontend <span class="text-orange-600">+30 hrs</span></span>
                  </label>

                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="features" value="safety" class="mr-3" data-hours="50">
                    <span class="text-slate-700 dark:text-slate-300">Safety/Medical Compliance <span class="text-orange-600">+50 hrs</span></span>
                  </label>

                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="features" value="enclosure" class="mr-3" data-hours="25">
                    <span class="text-slate-700 dark:text-slate-300">Custom Enclosure Design <span class="text-orange-600">+25 hrs</span></span>
                  </label>

                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="features" value="testing" class="mr-3" data-hours="20">
                    <span class="text-slate-700 dark:text-slate-300">Extended Testing/Validation <span class="text-orange-600">+20 hrs</span></span>
                  </label>
                </div>
              </div>
            </div>
          </div>

          <!-- Results -->
          <div id="calc-results" style="display: none;" class="mt-8">
            <div class="bg-white dark:bg-slate-900 rounded-xl p-6 border-2 border-slate-200 dark:border-slate-600">
              <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-4 text-center">Project Estimate</h3>

              <div class="grid md:grid-cols-3 gap-6 mb-6">
                <div class="text-center">
                  <div class="text-2xl font-bold text-orange-600 mb-1" id="total-hours">0 hours</div>
                  <div class="text-sm text-slate-600 dark:text-slate-400">Total Engineering Time</div>
                  <div class="text-xs text-slate-500 dark:text-slate-500">(10% less than typical)</div>
                </div>
                <div class="text-center">
                  <div class="text-2xl font-bold text-green-600 mb-1" id="total-cost">$0</div>
                  <div class="text-sm text-slate-600 dark:text-slate-400">Engineering Cost</div>
                  <div class="text-xs text-slate-500 dark:text-slate-500">@$140/hr</div>
                </div>
                <div class="text-center">
                  <div class="text-2xl font-bold text-blue-600 mb-1" id="timeline">0 weeks</div>
                  <div class="text-sm text-slate-600 dark:text-slate-400">Estimated Timeline</div>
                  <div class="text-xs text-slate-500 dark:text-slate-500">Start in 1-2 weeks</div>
                </div>
              </div>

              <div class="bg-slate-50 dark:bg-slate-800 rounded-lg p-4">
                <h4 class="font-bold text-slate-900 dark:text-white mb-2">Estimate Includes:</h4>
                <ul class="text-sm text-slate-700 dark:text-slate-300 space-y-1" id="included-items">
                  <li>• Requirements analysis and feasibility study</li>
                  <li>• Complete design and development</li>
                  <li>• Testing and validation</li>
                  <li>• Documentation package</li>
                </ul>

                <div class="mt-4 text-xs text-slate-600 dark:text-slate-400">
                  <strong>Note:</strong> This excludes component costs, PCB fabrication, and assembly.
                  Add 20-40% for complete project budget including materials.
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- RFQ Form -->
        <div class="bg-white dark:bg-slate-900 rounded-2xl p-10 mb-16 border-2 border-slate-200 dark:border-slate-700 hover:shadow-2xl hover:shadow-orange-500/20 dark:hover:shadow-none hover:border-orange-500 dark:hover:border-orange-400 hover:scale-[1.01] transition-all duration-500">
          <h2 class="text-2xl font-bold text-slate-800 dark:text-slate-100 mb-8 text-center">
            Detailed Quote Request
          </h2>

          <form action="https://usebasin.com/f/00c426b2708e" method="POST">

            <!-- Company & Contact Information -->
            <div class="mb-6">
              <h3 class="text-xl font-semibold text-slate-800 dark:text-slate-100 mb-4 border-b border-slate-200 dark:border-slate-700 pb-2">
                Company & Contact Information
              </h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Company Name -->
                <div>
                  <label for="company" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                    Company Name *
                  </label>
                  <input
                    type="text"
                    name="company"
                    id="company"
                    class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 placeholder:text-slate-500 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:placeholder:text-slate-400 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                    placeholder="Your Company Name"
                    required
                  />
                </div>

                <!-- Industry -->
                <div>
                  <label for="industry" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                    Industry
                  </label>
                  <select
                    name="industry"
                    id="industry"
                    class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                  >
                    <option value="">Select Industry</option>
                    <option value="healthcare-medical">Healthcare & Medical Devices</option>
                    <option value="industrial-automation">Industrial Automation</option>
                    <option value="robotics">Robotics</option>
                    <option value="iot-connected-devices">IoT & Connected Devices</option>
                    <option value="automotive">Automotive</option>
                    <option value="aerospace-defense">Aerospace & Defense</option>
                    <option value="consumer-electronics">Consumer Electronics</option>
                    <option value="renewable-energy">Renewable Energy</option>
                    <option value="telecommunications">Telecommunications</option>
                    <option value="transportation">Transportation</option>
                    <option value="other">Other</option>
                  </select>
                </div>

                <!-- Contact Name -->
                <div>
                  <label for="contact-name" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                    Your Name *
                  </label>
                  <input
                    type="text"
                    name="contact-name"
                    id="contact-name"
                    class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 placeholder:text-slate-500 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:placeholder:text-slate-400 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                    placeholder="Your Full Name"
                    required
                  />
                </div>

                <!-- Title/Role -->
                <div>
                  <label for="title" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                    Title/Role
                  </label>
                  <input
                    type="text"
                    name="title"
                    id="title"
                    class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 placeholder:text-slate-500 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:placeholder:text-slate-400 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                    placeholder="e.g., Engineering Manager, CTO"
                  />
                </div>

                <!-- Email -->
                <div>
                  <label for="email" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                    Email Address *
                  </label>
                  <input
                    type="email"
                    name="email"
                    id="email"
                    class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 placeholder:text-slate-500 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:placeholder:text-slate-400 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                    placeholder="your.email@company.com"
                    required
                  />
                </div>

                <!-- Phone -->
                <div>
                  <label for="phone" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                    Phone Number
                  </label>
                  <input
                    type="tel"
                    name="phone"
                    id="phone"
                    class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 placeholder:text-slate-500 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:placeholder:text-slate-400 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                    placeholder="(555) 123-4567"
                  />
                </div>
              </div>
            </div>

            <!-- Project Information -->
            <div class="mb-6">
              <h3 class="text-xl font-semibold text-slate-800 dark:text-slate-100 mb-4 border-b border-slate-200 dark:border-slate-700 pb-2">
                Project Information
              </h3>

              <!-- Project Description -->
              <div class="mb-4">
                <label for="project-description" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                  Project Description *
                </label>
                <textarea
                  name="project-description"
                  id="project-description"
                  rows="4"
                  class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 placeholder:text-slate-500 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:placeholder:text-slate-400 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                  placeholder="Describe your project, what problem it solves, key requirements..."
                  required
                ></textarea>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Budget Range -->
                <div>
                  <label for="budget" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                    Budget Range
                  </label>
                  <select
                    name="budget"
                    id="budget"
                    class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                  >
                    <option value="">Select Budget Range</option>
                    <option value="under-10k">Under $10,000</option>
                    <option value="10k-25k">$10,000 - $25,000</option>
                    <option value="25k-50k">$25,000 - $50,000</option>
                    <option value="50k-100k">$50,000 - $100,000</option>
                    <option value="over-100k">Over $100,000</option>
                  </select>
                </div>

                <!-- Timeline -->
                <div>
                  <label for="timeline" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                    Target Timeline
                  </label>
                  <select
                    name="timeline"
                    id="timeline"
                    class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                  >
                    <option value="">Select Timeline</option>
                    <option value="asap">ASAP (Rush job)</option>
                    <option value="1-3months">1-3 months</option>
                    <option value="3-6months">3-6 months</option>
                    <option value="6months-plus">6+ months</option>
                    <option value="flexible">Flexible</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Additional Information -->
            <div class="mb-8">
              <label for="additional-info" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                Additional Information
              </label>
              <textarea
                name="additional-info"
                id="additional-info"
                rows="3"
                class="block w-full rounded-xl border border-slate-200/50 bg-white/50 backdrop-blur-sm px-4 py-3 text-sm text-slate-700 placeholder:text-slate-500 focus:border-orange-300 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-600/50 dark:bg-neutral-700/30 dark:text-slate-300 dark:placeholder:text-slate-400 dark:focus:border-orange-400 dark:focus:ring-orange-400/20"
                placeholder="Any special requirements, constraints, or questions..."
              ></textarea>
            </div>

            <!-- Hidden Calculator Data -->
            <input type="hidden" name="calculator-estimate" id="calc-estimate-hidden" value="">

            <!-- Submit Button -->
            <div class="text-center">
              <button
                type="submit"
                class="inline-flex items-center justify-center rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 px-8 py-4 text-base font-bold text-white shadow-lg transition-all duration-200 hover:from-orange-600 hover:to-orange-700 hover:shadow-xl hover:scale-105 focus:outline-none focus:ring focus:ring-orange-200/30 disabled:pointer-events-none disabled:opacity-50"
              >
                Submit Quote Request
                <svg class="ml-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                </svg>
              </button>
            </div>

            <div class="text-center mt-4">
              <p class="text-sm text-slate-600 dark:text-slate-400">
                We'll respond within 24 hours with a detailed proposal. Questions? Call <a href="{phoneHref}" class="text-orange-500 hover:text-orange-600 font-medium">{phone}</a>
              </p>
            </div>
          </form>
        </div>
      </div>
    </Container>
  </Layout>
</main>

<style>
  .calc-option-card.selected {
    @apply border-orange-500 bg-orange-50 dark:bg-orange-900/20;
  }
</style>

<script>
  // Calculator Elements
  const projectTypes = document.querySelectorAll('.calc-project-type');
  const calcDetails = document.getElementById('calc-details');
  const calcResults = document.getElementById('calc-results');
  const totalHoursEl = document.getElementById('total-hours');
  const totalCostEl = document.getElementById('total-cost');
  const timelineEl = document.getElementById('timeline');
  const includedItemsEl = document.getElementById('included-items');
  const calcEstimateHidden = document.getElementById('calc-estimate-hidden');

  const HOURLY_RATE = 140;
  const EFFICIENCY_MULTIPLIER = 0.9; // 10% fewer hours than typical

  // Project type selection
  projectTypes.forEach(radio => {
    radio.addEventListener('change', () => {
      // Update UI
      document.querySelectorAll('.calc-option-card').forEach(card => {
        card.classList.remove('selected');
      });
      if (radio.checked) {
        radio.closest('label').querySelector('.calc-option-card').classList.add('selected');
        calcDetails.style.display = 'block';
        updateCalculation();
      }
    });
  });

  // Listen for changes on all calculator inputs
  document.addEventListener('change', (e) => {
    if (e.target.matches('input[name="complexity"], select[name="pcb-layers"], select[name="component-count"], input[name="features"]')) {
      updateCalculation();
    }
  });

  function updateCalculation() {
    const selectedType = document.querySelector('.calc-project-type:checked');
    if (!selectedType) return;

    let baseHours = parseInt(selectedType.dataset.baseHours);
    let description = selectedType.dataset.description;

    // Apply complexity multiplier
    const complexity = document.querySelector('input[name="complexity"]:checked');
    if (complexity) {
      const multiplier = parseFloat(complexity.dataset.multiplier);
      baseHours = Math.round(baseHours * multiplier);
    }

    // Add PCB layer complexity
    const pcbLayers = document.querySelector('select[name="pcb-layers"]');
    if (pcbLayers.value) {
      const layerHours = parseInt(pcbLayers.selectedOptions[0].dataset.hours);
      baseHours += layerHours;
    }

    // Add component count complexity
    const componentCount = document.querySelector('select[name="component-count"]');
    if (componentCount.value) {
      const componentHours = parseInt(componentCount.selectedOptions[0].dataset.hours);
      baseHours += componentHours;
    }

    // Add feature hours
    const features = document.querySelectorAll('input[name="features"]:checked');
    features.forEach(feature => {
      const featureHours = parseInt(feature.dataset.hours);
      baseHours += featureHours;
    });

    // Apply efficiency multiplier (10% fewer hours)
    const finalHours = Math.round(baseHours * EFFICIENCY_MULTIPLIER);
    const cost = finalHours * HOURLY_RATE;
    const weeks = Math.ceil(finalHours / 35); // Assuming 35 hours/week

    // Update display
    totalHoursEl.textContent = `${finalHours} hours`;
    totalCostEl.textContent = `$${cost.toLocaleString()}`;
    timelineEl.textContent = `${weeks} weeks`;

    // Update included items based on project type
    const baseItems = [
      '• Requirements analysis and feasibility study',
      '• Complete design and development',
      '• Testing and validation',
      '• Documentation package'
    ];

    if (selectedType.value === 'development') {
      baseItems.push('• PCB schematic and layout files');
      baseItems.push('• Firmware source code');
      baseItems.push('• Manufacturing documentation');
    } else if (selectedType.value === 'testing') {
      baseItems.push('• Test procedures and reports');
      baseItems.push('• Compliance documentation');
    }

    includedItemsEl.innerHTML = baseItems.join('\n');

    // Store estimate for form submission
    const estimate = {
      hours: finalHours,
      cost: cost,
      timeline: weeks,
      projectType: selectedType.value,
      description: description
    };
    calcEstimateHidden.value = JSON.stringify(estimate);

    calcResults.style.display = 'block';
  }
</script>