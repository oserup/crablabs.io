---
import Layout from '../layouts/Layout.astro';
import Container from '../components/Container.astro';

// Case study data organized by industry
const industries = [
  {
    id: 'medical',
    name: 'Medical',
    color: '#dc2626',
    studies: [
      {
        id: 'medical-imaging',
        title: 'Ultrasound Positioning Controller',
        subtitle: 'Precision 5-axis motion system for medical imaging equipment',
        scope: 'Hardware + Firmware',
        timeline: '6 mo',
        context: 'A client came to us after another firm delivered a board with electromagnetic interference issues and manufacturing defects. The original design used five separate driver boards connected by complicated custom connectors and cabling—very labor intensive to assemble.',
        work: 'We consolidated everything onto a single 6-layer PCB with TI-based motor drivers for all five axes controlling ~20W of low-inductance motors. A TI C2000 series MCU handles real-time control. USB-C provides both power and communication.',
        outcome: 'Achieved +/-0.1mm positioning accuracy. Eliminated spurious emissions—now passes both radiated and conducted emissions testing. Passed IEC 60601 medical pre-compliance on first attempt. Final design was 3x smaller and 10x cheaper than the original.'
      },
      {
        id: 'neonatal-monitor',
        title: 'Neonatal Biomarker Patch',
        subtitle: 'Wireless wearable sensor for infant monitoring studies',
        scope: 'Hardware + Firmware',
        timeline: '4 mo',
        context: 'A medical device startup needed hardware for an investigational study. The device had to be small enough for neonatal skin, run for extended periods, and survive repeated sterilization.',
        work: 'We designed an ultra-compact board (~1" square, 1.5cm tall, 2oz) with a multi-sensor front-end including ECG and PPG. An nRF54 handles BLE connectivity. Sleep mode management and sensor-specific power controls maximize battery life.',
        outcome: 'Achieved 24-hour continuous operation and 1-year standby. Delivered a rechargeable, reusable device suitable for long-term clinical use. Used successfully in the client\'s pilot study.'
      }
    ]
  },
  {
    id: 'industrial',
    name: 'Industrial',
    color: '#2563eb',
    studies: [
      {
        id: 'industrial-power',
        title: 'Intelligent PDU Controller',
        subtitle: 'Connected power distribution with remote monitoring',
        scope: 'Hardware + Firmware + UI',
        timeline: '11 mo',
        context: 'An industrial equipment manufacturer needed to modernize their power distribution unit product line. Existing units had no remote monitoring, and customers wanted connectivity and building automation integration.',
        work: 'We built a dual-processor architecture: a Raspberry Pi CM5 runs the UI and networking while an ESP32-S3 handles real-time I/O. A 13-inch touchscreen provides local control. The system interfaces with up to 15 external meters (12 feeds) and supports Modbus, SNMP, BACnet, and HTTPS for broad compatibility.',
        outcome: 'Delivered a complete UI and remote administration/control tool. Client launched an updated product line with fleet management capabilities. Now deployed in datacenters and commercial buildings.'
      },
      {
        id: 'bldc-motor-controller',
        title: 'GaN Motor Controller',
        subtitle: 'Compact 4kW brushless motor driver',
        scope: 'Hardware + Firmware',
        timeline: '6 mo',
        context: 'A client needed a 4kW brushless motor controller in a smaller form factor than existing solutions. The application required fast torque response and low acoustic noise from a 72V bus.',
        work: 'We used EPC gallium nitride (GaN) transistors for high switching efficiency. A TI C2000 series MCU runs the FOC control loop. PCB layout was optimized for thermal performance with heatsink integration.',
        outcome: '98% efficiency at 3kW. 40% smaller and 50% lighter than the predecessor. Lower acoustic noise. Compact enough to mount directly on the motor housing.'
      }
    ]
  },
  {
    id: 'scientific',
    name: 'Scientific',
    color: '#7c3aed',
    studies: [
      {
        id: 'scientific-instrument',
        title: 'Gravimeter Modernization',
        subtitle: 'Digital upgrade for legacy gravity measurement instruments',
        scope: 'Hardware + Firmware',
        timeline: '4 mo',
        context: 'LaCoste-Romberg gravimeters are precision instruments used in geophysical surveys to measure subtle variations in Earth\'s gravity. The original manufacturer went out of business, leaving critical components unavailable.',
        work: 'We designed a two-part system. An internal module with an ESP32 adds a 16-bit ADC with oversampling, OLED display, and expansion interface. A wired external data logger provides automatic data capture with GPS tagging, WiFi, and BLE connectivity.',
        outcome: 'Improved noise floor, reduced drift, and increased accuracy and precision over the original. Extended the life of instruments that would otherwise be scrapped. Client can now perform automated surveys with GPS-tagged data.'
      },
      {
        id: 'aeroponics-controller',
        title: 'Aeroponics Research Platform',
        subtitle: 'Precision misting system for soil-free plant cultivation',
        scope: 'Hardware + Firmware',
        timeline: '4 mo',
        context: 'An ag-tech startup was developing an aeroponics system for plant research. Aeroponics grows plants by misting roots with nutrient solution instead of using soil. Off-the-shelf components could not achieve the flow stability needed for reproducible experiments.',
        work: 'We designed custom driver boards using a Silicon Labs BGM series MCU. Closed-loop control uses piezo feedback to maintain precise misting from a static pressure system. Environmental sensors track temperature and humidity. Bluetooth enables wireless monitoring and parameter adjustment.',
        outcome: 'Achieved 99%+ flow stability. Enabled the client to file patents and establish university research partnerships.'
      }
    ]
  }
];
---

<Layout
  title="Electronics Engineering Case Studies - Medical, Industrial, Scientific | Crab Labs"
  description="Real project examples: ultrasound controllers, neonatal monitors, GaN power systems, industrial automation. See how we deliver from concept to certified product."
>
  <style>
    /* ==========================================
       SECTIONS - Light backgrounds (matches site)
       ========================================== */
    .section {
      padding: 5rem 0;
      position: relative;
    }

    .section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: repeating-linear-gradient(90deg, #e5e5e5 0px, #e5e5e5 4px, transparent 4px, transparent 8px);
    }

    .section-white { background: #ffffff; }
    .section-gray { background: #fafafa; }
    .section-first { padding-top: 3rem; padding-bottom: 3rem; }
    .section-first::before { display: none; }

    .section-header {
      margin-bottom: 3rem;
    }

    .section-label {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-family: var(--font-mono);
      font-size: 0.6875rem;
      font-weight: 600;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: #a3a3a3;
      margin-bottom: 0.75rem;
    }

    .section-label::before {
      content: '//';
      color: #d4d4d4;
    }

    .section-title {
      font-family: var(--font-display);
      font-size: clamp(1.75rem, 4vw, 2.25rem);
      font-weight: 600;
      letter-spacing: -0.02em;
      color: #171717;
    }

    .section-subtitle {
      font-size: 1rem;
      color: #737373;
      margin-top: 0.5rem;
      max-width: 480px;
    }

    /* ==========================================
       INDUSTRY SECTION HEADER
       ========================================== */
    .industry-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .industry-marker {
      width: 3px;
      height: 1.25rem;
      border-radius: 2px;
    }

    .industry-name {
      font-family: var(--font-display);
      font-size: 1.125rem;
      font-weight: 600;
      color: #171717;
      letter-spacing: -0.01em;
    }

    /* ==========================================
       CASE STUDY CARDS
       ========================================== */
    .studies-grid {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .study-card {
      background: #ffffff;
      border: 1px solid #e5e5e5;
      border-radius: 4px;
      overflow: hidden;
      transition: all 0.2s ease;
    }

    .study-card:hover {
      border-color: var(--study-color, #d4d4d4);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.04);
    }

    .study-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 1.25rem 1.5rem;
      border-bottom: 1px solid #f5f5f5;
      gap: 1rem;
    }

    .study-title {
      font-family: var(--font-display);
      font-size: 1rem;
      font-weight: 600;
      color: #171717;
      margin-bottom: 0.25rem;
    }

    .study-subtitle {
      font-size: 0.8125rem;
      color: #737373;
    }

    .study-meta {
      text-align: right;
      flex-shrink: 0;
    }

    .study-timeline {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--study-color, #525252);
    }

    .study-scope {
      font-size: 0.6875rem;
      color: #a3a3a3;
      margin-top: 0.125rem;
    }

    .study-content {
      padding: 1.25rem 1.5rem;
      display: grid;
      gap: 1rem;
    }

    @media (min-width: 768px) {
      .study-content {
        grid-template-columns: 1fr 1fr 1fr;
        gap: 1.5rem;
      }
    }

    .study-block-label {
      font-family: var(--font-mono);
      font-size: 0.625rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: #a3a3a3;
      margin-bottom: 0.5rem;
    }

    .study-block-label.accent {
      color: var(--study-color, #525252);
    }

    .study-block-text {
      font-size: 0.8125rem;
      color: #525252;
      line-height: 1.6;
    }

    .study-block-text.outcome {
      color: #171717;
      font-weight: 500;
    }

  </style>

  <!-- Page Header -->
  <section class="section section-gray section-first">
    <Container>
      <div class="section-header">
        <div class="section-label">Case Studies</div>
        <h1 class="section-title">Our work</h1>
        <p class="section-subtitle">Selected projects from medical devices, industrial systems, and scientific instruments.</p>
      </div>
    </Container>
  </section>

  <!-- Industry Sections -->
  {industries.map((industry, index) => (
    <section class={`section ${index % 2 === 0 ? 'section-white' : 'section-gray'}`} id={industry.id} style={`--study-color: ${industry.color}`}>
      <Container>
        <div class="industry-header">
          <div class="industry-marker" style={`background: ${industry.color}`}></div>
          <h2 class="industry-name">{industry.name}</h2>
        </div>

        <div class="studies-grid">
          {industry.studies.map((study) => (
            <article class="study-card">
              <div class="study-header">
                <div>
                  <h3 class="study-title">{study.title}</h3>
                  <p class="study-subtitle">{study.subtitle}</p>
                </div>
                <div class="study-meta">
                  <div class="study-timeline">{study.timeline}</div>
                  <div class="study-scope">{study.scope}</div>
                </div>
              </div>

              <div class="study-content">
                <div>
                  <div class="study-block-label">Context</div>
                  <p class="study-block-text">{study.context}</p>
                </div>
                <div>
                  <div class="study-block-label accent">Work</div>
                  <p class="study-block-text">{study.work}</p>
                </div>
                <div>
                  <div class="study-block-label">Outcome</div>
                  <p class="study-block-text outcome">{study.outcome}</p>
                </div>
              </div>
            </article>
          ))}
        </div>
      </Container>
    </section>
  ))}

</Layout>
