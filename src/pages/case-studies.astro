---
import Layout from '../layouts/Layout.astro';
import Container from '../components/Container.astro';

// Case study data organized by industry
const industries = [
  {
    id: 'medical',
    name: 'Medical',
    color: 'red',
    studies: [
      {
        id: 'medical-imaging',
        title: 'Ultrasound Positioning Controller',
        subtitle: 'Precision 5-axis motion system for medical imaging equipment',
        scope: 'Hardware + Firmware',
        timeline: '6 mo',
        context: 'A client came to us after another firm delivered a board with electromagnetic interference issues and manufacturing defects. The original design used five separate driver boards connected by custom cables.',
        work: 'We consolidated everything onto a single 6-layer PCB with integrated motor drivers for all five axes. USB-C handles both power and communication.',
        outcome: 'Achieved +/-0.1mm positioning accuracy. Passed IEC 60601 medical pre-compliance on first attempt. Final design was 3x smaller and 10x cheaper than the original.'
      },
      {
        id: 'neonatal-monitor',
        title: 'Neonatal Biomarker Patch',
        subtitle: 'Wireless wearable sensor for infant monitoring studies',
        scope: 'Hardware + Firmware',
        timeline: '4 mo',
        context: 'A medical device startup needed hardware for an investigational study. The device had to be small enough for neonatal skin, run for extended periods, and survive repeated sterilization.',
        work: 'We designed an ultra-compact board with a multi-sensor front-end and Bluetooth connectivity. Aggressive power management extends battery life significantly. We collaborated with a partner firm on the enclosure.',
        outcome: 'Delivered a rechargeable, reusable device suitable for long-term clinical use. Used successfully in the client\'s pilot study.'
      }
    ]
  },
  {
    id: 'industrial',
    name: 'Industrial',
    color: 'blue',
    studies: [
      {
        id: 'industrial-power',
        title: 'Intelligent PDU Controller',
        subtitle: 'Connected power distribution with remote monitoring',
        scope: 'Hardware + Firmware + UI',
        timeline: '11 mo',
        context: 'An industrial equipment manufacturer needed to modernize their power distribution unit product line. Existing units had no remote monitoring, and customers wanted connectivity and building automation integration.',
        work: 'We built a dual-processor architecture combining a Linux system-on-module with a microcontroller. A 13-inch touchscreen provides local control. The system supports Modbus, SNMP, BACnet, and HTTPS for broad compatibility, plus ground fault monitoring and temperature sensing.',
        outcome: 'Client launched an updated product line with fleet management capabilities. Now deployed in datacenters and commercial buildings.'
      },
      {
        id: 'bldc-motor-controller',
        title: 'GaN Motor Controller',
        subtitle: 'Compact 4kW brushless motor driver',
        scope: 'Hardware + Firmware',
        timeline: '6 mo',
        context: 'A client needed a 4kW brushless motor controller in a smaller form factor than existing solutions. The application required fast torque response and low acoustic noise.',
        work: 'We used gallium nitride (GaN) transistors for high efficiency in a compact package. The PCB layout was optimized for heat dissipation, and a high-bandwidth control loop ensures smooth, quiet operation.',
        outcome: 'Delivered higher efficiency and lower acoustic noise than the predecessor. Compact enough to mount directly on the motor housing.'
      }
    ]
  },
  {
    id: 'scientific',
    name: 'Scientific',
    color: 'purple',
    studies: [
      {
        id: 'scientific-instrument',
        title: 'Gravimeter Modernization',
        subtitle: 'Digital upgrade for legacy gravity measurement instruments',
        scope: 'Hardware + Firmware',
        timeline: '4 mo',
        context: 'LaCoste-Romberg gravimeters are precision instruments used in geophysical surveys to measure subtle variations in Earth\'s gravity. The original manufacturer went out of business, leaving critical components unavailable.',
        work: 'We designed a two-part system. An internal module adds a precision analog-to-digital converter, OLED display, and expansion interface. An external data logger provides automatic data capture with GPS tagging and wireless connectivity.',
        outcome: 'Extended the life of instruments that would otherwise be scrapped. The client can now perform automated surveys with GPS-tagged data.'
      },
      {
        id: 'aeroponics-controller',
        title: 'Aeroponics Research Platform',
        subtitle: 'Precision misting system for soil-free plant cultivation',
        scope: 'Hardware + Firmware',
        timeline: '4 mo',
        context: 'An ag-tech startup was developing an aeroponics system for plant research. Aeroponics grows plants by misting roots with nutrient solution instead of using soil. Off-the-shelf components could not achieve the flow stability needed for reproducible experiments.',
        work: 'We designed custom driver boards with closed-loop flow control to maintain precise misting rates. Bluetooth connectivity enables wireless monitoring and parameter adjustment.',
        outcome: 'Achieved 99%+ flow stability. Enabled the client to file patents and establish university research partnerships.'
      }
    ]
  }
];

const colorClasses: Record<string, { accent: string; bg: string; gradient: string; light: string }> = {
  red: { accent: 'text-red-600', bg: 'bg-red-600', gradient: 'from-red-500 to-red-600', light: 'bg-red-50' },
  blue: { accent: 'text-blue-600', bg: 'bg-blue-600', gradient: 'from-blue-500 to-blue-600', light: 'bg-blue-50' },
  purple: { accent: 'text-purple-600', bg: 'bg-purple-600', gradient: 'from-purple-500 to-purple-600', light: 'bg-purple-50' }
};
---

<Layout
  title="Case Studies | Crab Labs"
  description="Medical devices, industrial systems, scientific instruments. Hardware and firmware projects."
>
  <div class="page-container">
    <Container>
      <div class="py-16 lg:py-24">

        <!-- Header -->
        <section class="max-w-xl mb-16">
          <p class="text-sm font-mono text-brand-600 mb-2">Case Studies</p>
          <h1 class="text-4xl lg:text-5xl font-display font-semibold text-neutral-900 mb-4">Our work</h1>
          <p class="text-xl text-neutral-600">
            Selected projects from medical devices, industrial systems, and scientific instruments.
          </p>
        </section>

        <!-- Industry Sections -->
        {industries.map((industry) => (
          <section class="mb-16" id={industry.id}>
            <!-- Industry Header -->
            <div class="flex items-center gap-3 mb-6">
              <div class={`w-1 h-6 ${colorClasses[industry.color].bg} rounded-full`}></div>
              <h2 class="text-xl font-display font-semibold text-neutral-900">{industry.name}</h2>
            </div>

            <!-- Case Study Cards -->
            <div class="space-y-6">
              {industry.studies.map((study) => (
                <article class="relative bg-white border border-neutral-200 rounded-lg overflow-hidden">
                  <!-- Colored top bar -->
                  <div class={`absolute top-0 left-0 w-full h-1 bg-gradient-to-r ${colorClasses[industry.color].gradient}`}></div>

                  <!-- Header -->
                  <div class="px-6 py-4 border-b border-neutral-100">
                    <div class="flex items-start justify-between">
                      <div>
                        <h3 class="font-semibold text-neutral-900 text-lg">{study.title}</h3>
                        <p class="text-sm text-neutral-500">{study.subtitle}</p>
                      </div>
                      <div class="text-right ml-4 flex-shrink-0">
                        <span class="text-xs font-mono text-neutral-500 block">{study.timeline}</span>
                        <span class="text-xs text-neutral-400">{study.scope}</span>
                      </div>
                    </div>
                  </div>

                  <!-- Content -->
                  <div class="p-6 space-y-4">
                    <div>
                      <h4 class="text-xs font-mono text-neutral-400 uppercase tracking-wide mb-1">Context</h4>
                      <p class="text-sm text-neutral-600 leading-relaxed">{study.context}</p>
                    </div>

                    <div>
                      <h4 class={`text-xs font-mono ${colorClasses[industry.color].accent} uppercase tracking-wide mb-1`}>What we built</h4>
                      <p class="text-sm text-neutral-600 leading-relaxed">{study.work}</p>
                    </div>

                    <div>
                      <h4 class="text-xs font-mono text-neutral-400 uppercase tracking-wide mb-1">Outcome</h4>
                      <p class="text-sm text-neutral-700 leading-relaxed font-medium">{study.outcome}</p>
                    </div>
                  </div>
                </article>
              ))}
            </div>
          </section>
        ))}

      </div>
    </Container>
  </div>
</Layout>
